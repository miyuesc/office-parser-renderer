---
name: å•ä½è½¬æ¢å®Œæ•´å‚è€ƒ
description: OOXML æ–‡æ¡£ä¸­æ‰€æœ‰å•ä½ï¼ˆEMUã€Twipsã€Pointsã€DXAã€Picaã€æ¯«ç±³ã€å˜ç±³ã€è‹±å¯¸ã€è§’åº¦ã€ç™¾åˆ†æ¯”ç­‰ï¼‰çš„å®Œæ•´è½¬æ¢å‚è€ƒ
trigger: context
---

# å•ä½è½¬æ¢å®Œæ•´å‚è€ƒ

## ğŸ“ å•ä½ä½“ç³»æ¦‚è§ˆ

Office æ–‡æ¡£ä½¿ç”¨å¤šç§å•ä½ä½“ç³»ï¼Œç†è§£å®ƒä»¬ä¹‹é—´çš„å…³ç³»å¯¹äºç²¾ç¡®æ¸²æŸ“è‡³å…³é‡è¦ã€‚

### å•ä½å…³ç³»å›¾

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   è‹±å¯¸ (in)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚                  â”‚
        â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EMU (914400)  â”‚  â”‚ Twips (1440)  â”‚  â”‚ Points (72)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                  â”‚                  â”‚
        â”‚                  â”‚                  â”‚
        â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ mm (25.4)     â”‚  â”‚ DXA (= Twips) â”‚  â”‚ Half Pt (2x)  â”‚
â”‚ cm (2.54)     â”‚  â”‚               â”‚  â”‚ 8th Pt (8x)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”¢ åŸºç¡€å•ä½å¸¸é‡

### æ¯è‹±å¯¸çš„å•ä½æ•°é‡

| å•ä½ | æ¯è‹±å¯¸æ•°é‡ | è¯´æ˜ |
|------|-----------|------|
| **EMU** | 914,400 | English Metric Unitï¼ŒDrawingML åŸºç¡€å•ä½ |
| **Twips** | 1,440 | 1/20 ç‚¹ï¼ŒWordprocessingML å¸¸ç”¨ |
| **DXA** | 1,440 | Twips çš„åˆ«å |
| **Points** | 72 | å°åˆ·è¡Œä¸šæ ‡å‡†å•ä½ |
| **Pica** | 6 | 1 Pica = 12 Points |
| **æ¯«ç±³ (mm)** | 25.4 | å…¬åˆ¶é•¿åº¦å•ä½ |
| **å˜ç±³ (cm)** | 2.54 | å…¬åˆ¶é•¿åº¦å•ä½ |
| **åƒç´  (px)** | 96 (DPI) | å±å¹•æ˜¾ç¤ºå•ä½ |

### EMU ç›¸å…³å¸¸é‡

| æè¿° | å¸¸é‡å | å€¼ |
|------|--------|-----|
| æ¯è‹±å¯¸ EMU | `EMU_PER_INCH` | 914,400 |
| æ¯æ¯«ç±³ EMU | `EMU_PER_MM` | 36,000 |
| æ¯å˜ç±³ EMU | `EMU_PER_CM` | 360,000 |
| æ¯ç‚¹ EMU | `EMU_PER_POINT` | 12,700 |
| æ¯ Twip EMU | `EMU_PER_TWIP` | 635 |

### Twips ç›¸å…³å¸¸é‡

| æè¿° | å¸¸é‡å | å€¼ |
|------|--------|-----|
| æ¯è‹±å¯¸ Twips | `TWIPS_PER_INCH` | 1,440 |
| æ¯æ¯«ç±³ Twips | `TWIPS_PER_MM` | â‰ˆ56.69 |
| æ¯å˜ç±³ Twips | `TWIPS_PER_CM` | â‰ˆ566.93 |
| æ¯ç‚¹ Twips | `TWIPS_PER_POINT` | 20 |

### ç‚¹ç›¸å…³å¸¸é‡

| æè¿° | å¸¸é‡å | å€¼ |
|------|--------|-----|
| æ¯è‹±å¯¸ç‚¹æ•° | `POINTS_PER_INCH` | 72 |
| ç‚¹åˆ°åƒç´  | `PT_TO_PX` | 1.333... (96/72) |
| åŠç‚¹åˆ°ç‚¹ | `HALF_POINT_TO_POINT` | 0.5 |
| å…«åˆ†ä¹‹ä¸€ç‚¹åˆ°ç‚¹ | `EIGHTH_POINT_TO_POINT` | 0.125 |

### è§’åº¦å¸¸é‡

| æè¿° | å¸¸é‡å | å€¼ | è¯´æ˜ |
|------|--------|-----|------|
| OOXML è§’åº¦å•ä½ | `OOXML_ANGLE_UNIT` | 60,000 | 1Â° = 60000 |
| VML è§’åº¦å•ä½ | `VML_ANGLE_UNIT` | 65,536 | 1Â° = 65536 |
| æœ€å¤§è§’åº¦å€¼ | `MAX_ANGLE_UNITS` | 21,600,000 | 360Â° |

### ç™¾åˆ†æ¯”å¸¸é‡

| æè¿° | å¸¸é‡å | å€¼ | è¯´æ˜ |
|------|--------|-----|------|
| OOXML ç™¾åˆ†æ¯”åŸºæ•° | `OOXML_PERCENT_BASE` | 100,000 | 100% = 100000 |
| åƒåˆ†æ¯”åŸºæ•° | `PERMILLE_BASE` | 1,000 | 100% = 1000 |

### è¡Œè·å¸¸é‡

| æè¿° | å¸¸é‡å | å€¼ | è¯´æ˜ |
|------|--------|-----|------|
| è¡Œè·å•ä½ | `LINE_SPACING_UNIT` | 240 | å•å€è¡Œè· = 240 |

---

## ğŸ“Š è½¬æ¢å…¬å¼é€ŸæŸ¥è¡¨

### EMU è½¬æ¢

```typescript
// EMU â†’ åƒç´  (96 DPI)
pixels = emu / 914400 * 96;  // æˆ– emu / 9525

// EMU â†’ ç‚¹
points = emu / 12700;

// EMU â†’ Twips
twips = emu / 635;

// EMU â†’ æ¯«ç±³
mm = emu / 36000;

// EMU â†’ å˜ç±³
cm = emu / 360000;

// EMU â†’ è‹±å¯¸
inches = emu / 914400;
```

### Twips / DXA è½¬æ¢

```typescript
// Twips â†’ åƒç´  (96 DPI)
pixels = twips / 1440 * 96;  // æˆ– twips / 15

// Twips â†’ ç‚¹
points = twips / 20;

// Twips â†’ EMU
emu = twips * 635;

// Twips â†’ æ¯«ç±³
mm = twips / 56.69;

// Twips â†’ å˜ç±³
cm = twips / 566.93;

// Twips â†’ è‹±å¯¸
inches = twips / 1440;
```

### ç‚¹è½¬æ¢

```typescript
// ç‚¹ â†’ åƒç´  (96 DPI)
pixels = points * 96 / 72;  // æˆ– points * 1.333

// ç‚¹ â†’ Twips
twips = points * 20;

// ç‚¹ â†’ EMU
emu = points * 12700;

// ç‚¹ â†’ æ¯«ç±³
mm = points * 25.4 / 72;

// ç‚¹ â†’ è‹±å¯¸
inches = points / 72;
```

### åˆ†æ•°ç‚¹è½¬æ¢

```typescript
// åŠç‚¹ â†’ ç‚¹ (ç”¨äºå­—å· w:sz)
points = halfPoints / 2;

// å…«åˆ†ä¹‹ä¸€ç‚¹ â†’ ç‚¹ (ç”¨äºè¾¹æ¡† w:szCs)
points = eighthPoints / 8;

// ç™¾åˆ†ä¹‹ä¸€ç‚¹ â†’ ç‚¹
points = hundredthPoints / 100;
```

### Pica è½¬æ¢

```typescript
// Pica â†’ ç‚¹
points = picas * 12;

// Pica â†’ åƒç´  (96 DPI)
pixels = picas * 16;  // 96 / 6

// Pica â†’ è‹±å¯¸
inches = picas / 6;
```

### ç‰©ç†å•ä½äº’è½¬

```typescript
// æ¯«ç±³ â†’ åƒç´  (96 DPI)
pixels = mm / 25.4 * 96;

// å˜ç±³ â†’ åƒç´  (96 DPI)
pixels = cm / 2.54 * 96;

// è‹±å¯¸ â†’ åƒç´  (96 DPI)
pixels = inches * 96;

// æ¯«ç±³ â†’ å˜ç±³
cm = mm / 10;

// å˜ç±³ â†’ è‹±å¯¸
inches = cm / 2.54;
```

### è§’åº¦è½¬æ¢

```typescript
// OOXML è§’åº¦ â†’ åº¦
degrees = ooxmlAngle / 60000;
// ä¾‹: 5400000 â†’ 90Â°

// OOXML è§’åº¦ â†’ å¼§åº¦
radians = ooxmlAngle / 60000 * Math.PI / 180;

// VML è§’åº¦ â†’ åº¦
degrees = vmlAngle / 65536;

// åº¦ â†’ å¼§åº¦
radians = degrees * Math.PI / 180;
```

### ç™¾åˆ†æ¯”è½¬æ¢

```typescript
// OOXML ç™¾åˆ†æ¯” â†’ å°æ•° (100% = 100000)
decimal = percent / 100000;
// ä¾‹: 50000 â†’ 0.5

// åƒåˆ†æ¯” â†’ å°æ•° (100% = 1000)
decimal = permille / 1000;
// ä¾‹: 500 â†’ 0.5

// æ™®é€šç™¾åˆ†æ¯” â†’ å°æ•° (100% = 100)
decimal = percent / 100;
```

---

## ğŸ› ï¸ UnitConverter API

é¡¹ç›®æä¾›äº†å®Œæ•´çš„ `UnitConverter` ç±»ï¼Œä½äº `packages/shared/src/styles/UnitConverter.ts`ã€‚

### EMU è½¬æ¢æ–¹æ³•

```typescript
import { UnitConverter } from '@ai-space/shared';

// EMU ä¸åƒç´ 
UnitConverter.emuToPixels(914400);      // 96
UnitConverter.pixelsToEmu(96);          // 914400

// EMU ä¸ç‚¹
UnitConverter.emuToPoints(12700);       // 1
UnitConverter.pointsToEmu(1);           // 12700

// EMU ä¸ Twips
UnitConverter.emuToTwips(635);          // 1
UnitConverter.twipsToEmu(1);            // 635

// EMU ä¸ç‰©ç†å•ä½
UnitConverter.emuToMm(36000);           // 1
UnitConverter.mmToEmu(1);               // 36000
UnitConverter.emuToCm(360000);          // 1
UnitConverter.cmToEmu(1);               // 360000
UnitConverter.emuToInches(914400);      // 1
UnitConverter.inchesToEmu(1);           // 914400
```

### Twips / DXA è½¬æ¢æ–¹æ³•

```typescript
// Twips ä¸åƒç´ 
UnitConverter.twipsToPixels(1440);      // 96
UnitConverter.pixelsToTwips(96);        // 1440

// Twips ä¸ç‚¹
UnitConverter.twipsToPoints(20);        // 1
UnitConverter.pointsToTwips(1);         // 20

// Twips ä¸ç‰©ç†å•ä½
UnitConverter.twipsToMm(56.69);         // â‰ˆ1
UnitConverter.mmToTwips(1);             // â‰ˆ57
UnitConverter.twipsToCm(566.93);        // â‰ˆ1
UnitConverter.cmToTwips(1);             // â‰ˆ567
UnitConverter.twipsToInches(1440);      // 1
UnitConverter.inchesToTwips(1);         // 1440

// DXA (Twips åˆ«å)
UnitConverter.dxaToPixels(1440);        // 96
UnitConverter.pixelsToDxa(96);          // 1440
```

### ç‚¹è½¬æ¢æ–¹æ³•

```typescript
// ç‚¹ä¸åƒç´ 
UnitConverter.pointsToPixels(72);       // 96
UnitConverter.pixelsToPoints(96);       // 72

// ç‚¹ä¸ç‰©ç†å•ä½
UnitConverter.pointsToMm(72);           // 25.4
UnitConverter.mmToPoints(25.4);         // 72
UnitConverter.pointsToCm(72);           // 2.54
UnitConverter.cmToPoints(2.54);         // 72
UnitConverter.pointsToInches(72);       // 1
UnitConverter.inchesToPoints(1);        // 72
```

### åˆ†æ•°ç‚¹è½¬æ¢æ–¹æ³•

```typescript
// åŠç‚¹ (ç”¨äºå­—å·)
UnitConverter.halfPointsToPoints(24);   // 12
UnitConverter.pointsToHalfPoints(12);   // 24
UnitConverter.halfPointsToPixels(24);   // 16

// å…«åˆ†ä¹‹ä¸€ç‚¹ (ç”¨äºè¾¹æ¡†)
UnitConverter.eighthPointsToPoints(8);  // 1
UnitConverter.pointsToEighthPoints(1);  // 8
UnitConverter.eighthPointsToPixels(8);  // 1.333

// ç™¾åˆ†ä¹‹ä¸€ç‚¹
UnitConverter.hundredthPointsToPoints(100); // 1
UnitConverter.pointsToHundredthPoints(1);   // 100
```

### Pica è½¬æ¢æ–¹æ³•

```typescript
UnitConverter.picasToPoints(1);         // 12
UnitConverter.pointsToPicas(12);        // 1
UnitConverter.picasToPixels(1);         // 16
UnitConverter.picasToInches(6);         // 1
```

### ç‰©ç†å•ä½äº’è½¬æ–¹æ³•

```typescript
// æ¯«ç±³
UnitConverter.mmToPixels(25.4);         // 96
UnitConverter.pixelsToMm(96);           // 25.4
UnitConverter.mmToCm(10);               // 1
UnitConverter.mmToInches(25.4);         // 1

// å˜ç±³
UnitConverter.cmToPixels(2.54);         // 96
UnitConverter.pixelsToCm(96);           // 2.54
UnitConverter.cmToMm(1);                // 10
UnitConverter.cmToInches(2.54);         // 1

// è‹±å¯¸
UnitConverter.inchesToPixels(1);        // 96
UnitConverter.pixelsToInches(96);       // 1
UnitConverter.inchesToMm(1);            // 25.4
UnitConverter.inchesToCm(1);            // 2.54
```

### è§’åº¦è½¬æ¢æ–¹æ³•

```typescript
// OOXML è§’åº¦
UnitConverter.ooxmlAngleToDegrees(5400000); // 90
UnitConverter.degreesToOoxmlAngle(90);      // 5400000
UnitConverter.ooxmlAngleToRadians(5400000); // Math.PI / 2

// VML è§’åº¦
UnitConverter.vmlAngleToDegrees(5898240);   // 90
UnitConverter.degreesToVmlAngle(90);        // 5898240

// åº¦ä¸å¼§åº¦
UnitConverter.degreesToRadians(180);        // Math.PI
UnitConverter.radiansToDegrees(Math.PI);    // 180
```

### ç™¾åˆ†æ¯”è½¬æ¢æ–¹æ³•

```typescript
// OOXML ç™¾åˆ†æ¯” (100% = 100000)
UnitConverter.percentToDecimal(50000);      // 0.5
UnitConverter.decimalToPercent(0.5);        // 50000

// åƒåˆ†æ¯” (100% = 1000)
UnitConverter.permilleToDecimal(500);       // 0.5
UnitConverter.decimalToPermille(0.5);       // 500

// æ™®é€šç™¾åˆ†æ¯” (100% = 100)
UnitConverter.normalPercentToDecimal(50);   // 0.5
UnitConverter.decimalToNormalPercent(0.5);  // 50
```

### è¡Œè·è®¡ç®—

```typescript
// è‡ªåŠ¨è¡Œè· (240 = å•å€)
UnitConverter.calculateLineHeight(360, 'auto');    // '1.5' (1.5å€è¡Œè·)
UnitConverter.calculateLineHeight(480, 'auto');    // '2' (åŒå€è¡Œè·)

// å›ºå®šè¡Œè· (Twips)
UnitConverter.calculateLineHeight(300, 'exact');   // '20px'

// æœ€å°è¡Œè· (Twips)
UnitConverter.calculateLineHeight(300, 'atLeast'); // '20px'
```

### Excel åˆ—å®½è½¬æ¢

```typescript
UnitConverter.excelCharWidthToPixels(10);          // 80 (10*7.5+5)
UnitConverter.pixelsToExcelCharWidth(80);          // 10
```

### é€šç”¨è§£ææ–¹æ³•

```typescript
// è§£æå¸¦å•ä½çš„å­—ç¬¦ä¸²
UnitConverter.parseToPixels('12pt');     // 16
UnitConverter.parseToPixels('2.54cm');   // 96
UnitConverter.parseToPixels('25.4mm');   // 96
UnitConverter.parseToPixels('1in');      // 96
UnitConverter.parseToPixels('1pc');      // 16 (Pica)
UnitConverter.parseToPixels('2em', 96, 16); // 32

// é™åˆ¶æ•°å€¼èŒƒå›´
UnitConverter.clamp(150, 0, 100);        // 100
UnitConverter.clamp(-10, 0, 100);        // 0
```

---

## ğŸ“ å¸¸è§åº”ç”¨åœºæ™¯

### 1. DrawingML å…ƒç´ å®šä½ (DOCX/XLSX/PPTX)

```xml
<a:xfrm rot="2700000">
  <a:off x="914400" y="457200"/>
  <a:ext cx="2743200" cy="1828800"/>
</a:xfrm>
```

```typescript
const left = UnitConverter.emuToPixels(914400);     // 96px
const top = UnitConverter.emuToPixels(457200);      // 48px
const width = UnitConverter.emuToPixels(2743200);   // 288px
const height = UnitConverter.emuToPixels(1828800);  // 192px
const rotation = UnitConverter.ooxmlAngleToDegrees(2700000); // 45Â°
```

### 2. DOCX é¡µé¢è®¾ç½®

```xml
<w:sectPr>
  <w:pgSz w:w="11906" w:h="16838"/>
  <w:pgMar w:top="1440" w:left="1440"/>
</w:sectPr>
```

```typescript
const pageWidth = UnitConverter.twipsToPixels(11906);  // â‰ˆ793px (A4)
const pageHeight = UnitConverter.twipsToPixels(16838); // â‰ˆ1122px
const margin = UnitConverter.twipsToPixels(1440);      // 96px (1 inch)
```

### 3. DOCX å­—å·

```xml
<w:rPr>
  <w:sz w:val="24"/>  <!-- åŠç‚¹ï¼Œ12pt -->
</w:rPr>
```

```typescript
const fontSize = UnitConverter.halfPointsToPoints(24);   // 12pt
const fontSizePx = UnitConverter.halfPointsToPixels(24); // 16px
```

### 4. DOCX è¾¹æ¡†

```xml
<w:bdr w:sz="12"/>  <!-- å…«åˆ†ä¹‹ä¸€ç‚¹ -->
```

```typescript
const borderWidth = UnitConverter.eighthPointsToPixels(12); // 2px
```

### 5. æ¸å˜è§’åº¦

```xml
<a:lin ang="5400000"/>  <!-- 90Â° -->
```

```typescript
const angle = UnitConverter.ooxmlAngleToDegrees(5400000); // 90
// CSS: linear-gradient(90deg, ...)
```

### 6. é€æ˜åº¦

```xml
<a:alpha val="50000"/>  <!-- 50% -->
```

```typescript
const opacity = UnitConverter.percentToDecimal(50000); // 0.5
// CSS: opacity: 0.5
```

---

## âš ï¸ å¸¸è§é™·é˜±

### 1. æ··æ·† OOXML ç™¾åˆ†æ¯”æ ¼å¼

```xml
<!-- 100000 = 100%ï¼Œä¸æ˜¯ 100 = 100% -->
<a:tint val="50000"/>  <!-- è¿™æ˜¯ 50%ï¼Œä¸æ˜¯ 500% -->
```

### 2. å­—å·å•ä½æ˜¯åŠç‚¹

```xml
<!-- w:sz çš„å€¼æ˜¯åŠç‚¹ï¼Œä¸æ˜¯ç‚¹ -->
<w:sz w:val="24"/>  <!-- è¿™æ˜¯ 12ptï¼Œä¸æ˜¯ 24pt -->
```

### 3. è§’åº¦å•ä½å·®å¼‚

```typescript
// OOXML: 1Â° = 60000
// VML: 1Â° = 65536 (æŸäº›å±æ€§)
// ä¸è¦æ··æ·†ï¼
```

### 4. DXA â‰  OOXML ç‰¹æœ‰

```
DXA åªæ˜¯ Twips çš„åˆ«åï¼Œæ²¡æœ‰é¢å¤–çš„è½¬æ¢ç³»æ•°
```

### 5. æ³¨æ„ DPI ä¾èµ–

```typescript
// è½¬æ¢åˆ°åƒç´ æ—¶è¦è€ƒè™‘ DPI
// é»˜è®¤ä½¿ç”¨ 96 DPIï¼Œé«˜åˆ†å±å¯èƒ½éœ€è¦è°ƒæ•´
UnitConverter.emuToPixels(914400, 144); // 144 DPI ç»“æœä¸åŒ
```

---

## ğŸ“ ç›¸å…³æ–‡ä»¶

- å¸¸é‡å®šä¹‰: `packages/shared/src/styles/constants.ts`
- è½¬æ¢å™¨: `packages/shared/src/styles/UnitConverter.ts`
- å¯¼å‡ºå…¥å£: `packages/shared/src/styles/index.ts`
