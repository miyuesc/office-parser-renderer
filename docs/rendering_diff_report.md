# 渲染差异说明文档

## 1. 概览
当前渲染器（Office Parser Renderer）能够正确解析并显示文档的基本文本内容、段落结构及基础页面布局。但在复杂图文混排、高级对象（图表、形状）以及精准样式（表格边框、页眉页脚精细度）方面，与 Office 原生渲染（参考截图）存在显著差异。

## 2. 详细差异对比

### 2.1 图表 (Charts)
- **目标效果**：截图中包含柱状图、饼图、折线图等统计图表，显示完整的图例、坐标轴、数据标签及配色风格。
- **当前效果**：页面对应位置仅显示 `[图表]` 文本占位符，或完全无法显示。
- **差异等级**：🔴 **严重缺失**
- **原因**：核心渲染器尚未实现 `c:chart` (ChartML) 的解析与 Canvas 绘制逻辑。

### 2.2 形状与绘图 (Shapes & Drawings)
- **目标效果**：包含复杂的流程图、箭头、标注、组合图形，具有渐变填充、阴影、三维效果及正确层叠关系。
- **当前效果**：
    - 部分简单形状（如矩形）可显示。
    - 复杂形状显示为黑色实心块或轮廓丢失。
    - 文本框内的文字位置偏移或被遮挡。
- **差异等级**：🟠 **部分缺失/错误**
- **原因**：`DrawingRenderer` 对 `presetShape` 的路径支持不全，且缺乏对高级效果（Effect Style）的完整支持。

### 2.3 页眉与页脚 (Header & Footer)
- **目标效果**：包含公司 Logo、装饰线条、页码（特定位置与格式）、文档标题等，且奇偶页可能不同。
- **当前效果**：仅显示基础文本（如“这是页眉1”），缺乏布局样式，缺少图片/Logo，位置紧贴页边，未正确处理分节符导致的页眉变化。
- **差异等级**：🟡 **样式差异**

### 2.4 表格 (Tables)
- **目标效果**：精确的单元格边框（粗细/颜色）、底纹填充、单元格合并、垂直对齐及文本换行。
- **当前效果**：表格结构基本正确，但：
    - 边框渲染粗糙，部分线条缺失或重叠。
    - 单元格内边距 (Cell Margins) 不准确，导致文字紧贴边框。
    - 复杂嵌套表格可能错位。
- **差异等级**：🟡 **样式差异**

### 2.5 页面布局与排版 (Layout)
- **目标效果**：严格遵循 A4 纸张大小，准确的分栏（Columns）、分页位置、行间距及段落间距。
- **当前效果**：
    - 页面流式布局基本正常，但分页位置与 Word 不一致（由于所有元素高度计算微小误差累积）。
    - 目前主要是单栏布局，若文档包含分栏可能未正确渲染。
- **差异等级**：🟡 **精度差异**

### 2.6 其他元素
- **图片**：部分嵌入图片显示正常，但在文本环绕（Text Wrapping）模式下可能覆盖文字。
- **公式**：若文档包含 MathML 公式，当前可能无法渲染或显示乱码。
- **域代码**：页码域、目录域等动态内容可能显示为源码或静态文本。
